---
import type { ImageMetadata } from 'astro';
import { Icon } from 'astro-icon/components';
import Image from 'astro/components/Image.astro';
import Button from './Button.astro';

interface Props {
    id?: number;
    title?: string;
    summary?: string;
    techStack?: string[];
    projectImgName?: string;
    projectImgAlt?: string;
    projectImgW?: number;
    projectImgH?: number;
    githubLink?: string;
    liveLink?: string;
    projectInfo?: string;
    featured?: boolean;
    projectsPage?: boolean;
}

const {
    id = 0,
    title = "Content Writing Website",
    summary = "Gorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam eu turpis molestie, dictum est a, mattis tellus.",
    techStack = ["react", "supabase", "tailwindcss"],
    projectImgName = "/src/assets/projectImages/default.jpg",
    projectImgAlt = "project",
    projectImgW = 475,
    projectImgH = 156,
    githubLink = "https://github.com/Keanin-Cupido",
    liveLink = "https://github.com/Keanin-Cupido",
    featured = true,
    projectsPage = true,
} = Astro.props as Props;

const images = import.meta.glob<{ default: ImageMetadata }>('/src/assets/projectImages/*.{jpeg,jpg,png,gif}');
if (!images[projectImgName]) throw new Error(`"${projectImgName}" does not exist in glob: "/src/assets/projectImages/*.{jpeg,jpg,png,gif}"`);
---

<article class="featured-project-card relative w-full max-w-[1400px] mx-auto h-[400px] overflow-hidden group">
    <!-- Background Image -->
    <div class="absolute inset-0 z-0">
        <Image 
            src={images[projectImgName]()} 
            alt={projectImgAlt} 
            width={projectImgW} 
            height={projectImgH} 
            class="w-full h-full object-cover object-center"
        />
    </div>

    <!-- Overlay -->
    <div class="absolute inset-0 bg-[#040b14] z-10 transition-opacity duration-300 group-hover:opacity-60"></div>

    <!-- Content Grid -->
    <div class="relative z-20 w-full h-full p-8 flex flex-col text-white">
        <div class="flex-grow grid grid-cols-3 gap-4">
            <!-- Title -->
            <div class="col-span-2 max-w-[80%]">
                <h3 class="text-2xl font-bold mb-2">{title}</h3>
                <p class="text-base opacity-85">{summary}</p>
            </div>

            <!-- Tech Stack -->
            <div class="col-start-3 flex flex-wrap justify-end gap-2">
                {techStack.map(tech => (
                    <span class="text-white inline-flex h-8 w-8 items-center justify-center cursor-default text-xl" aria-label={`${tech}`}>
                        <Icon class="icon" name={`devicon:${tech}`} />
                    </span>
                ))}
            </div>
        </div>

        <!-- Buttons -->
        <div class="mt-auto flex justify-between items-center">
            <Button
                title='More Info'
                link={`/projects/${id}`}
                variant='primary'
                newTab={false}
            />
            <div class="flex gap-4">
                <a href={githubLink} target="_blank" rel="noopener noreferrer" class="text-white hover:text-indigo-400">
                    <Icon name="mdi:github" class="w-6 h-6" />
                </a>
                <a href={liveLink} target="_blank" rel="noopener noreferrer" class="text-white hover:text-indigo-400">
                    <Icon name="mdi:web" class="w-6 h-6" />
                </a>
            </div>
        </div>
    </div>
</article>

<style>
    .featured-project-card {
        transition: transform 0.3s ease-in-out;
    }
    .featured-project-card:hover {
        transform: scale(1.02);
    }
</style>
